<div class="row">
  <div class="col-md-3">
    <h1>Produtos</h1>
  </div>
  <div class="offset-md-6 col-md-3" style="text-align: end;">
    <button mat-raised-button color="primary" (click)="dialogCadastrar()" class="mat-elevation-z4">
      Cadastrar produto
    </button>
  </div>
</div>
<hr>

<table mat-table [dataSource]="fonteProdutos" multiTemplateDataRows class="table-produtos">
  <!-- ID Column -->
  <ng-container matColumnDef="id">
    <th mat-header-cell *matHeaderCellDef>
      <span>ID</span>
    </th>
    <td class="cursor-pointer" mat-cell *matCellDef="let produto"> {{produto.id}} </td>
  </ng-container>

  <!-- Nome Column -->
  <ng-container matColumnDef="nome">
    <th mat-header-cell *matHeaderCellDef> <span>Nome</span> </th>
    <td class="cursor-pointer" mat-cell *matCellDef="let produto"> {{produto.nome}} </td>
  </ng-container>

  <!-- Preço Column -->
  <ng-container matColumnDef="preco">
    <th mat-header-cell *matHeaderCellDef> <span>Preço</span> </th>
    <td class="cursor-pointer" mat-cell *matCellDef="let produto"> {{produto.preco | currency}} </td>
  </ng-container>

  <!-- Status Column -->
  <ng-container matColumnDef="status">
    <th mat-header-cell *matHeaderCellDef> <span>Ativo</span> </th>
    <td mat-cell *matCellDef="let produto">
      <mat-slide-toggle #tooltip="matTooltip" matTooltip="Ativar / Desativar" matTooltipPosition="above"
        (change)="ativarDesativar(produto)" (click)="$event.stopPropagation()"
        [(ngModel)]="produto.status"></mat-slide-toggle>
    </td>
  </ng-container>

  <!-- Data Criação Column -->
  <ng-container matColumnDef="created_at">
    <th mat-header-cell *matHeaderCellDef> <span>Data Criação</span> </th>
    <td class="cursor-pointer" mat-cell *matCellDef="let produto"> {{produto.created_at | date:'dd/MM/yyyy' }} </td>
  </ng-container>

  <!-- Accordian expandido -->
  <ng-container matColumnDef="expandedDetail">
    <td mat-cell *matCellDef="let produto" [attr.colspan]="displayedColumns.length">
      <div class="produto-detail" [@detailExpand]="produto == expandedElement ? 'expanded' : 'collapsed'">
        <app-acordian [produto]="produto"></app-acordian>
      </div>
    </td>
  </ng-container>

  <tr mat-header-row *matHeaderRowDef="displayedColumns" class="header-table"></tr>
  <tr mat-row *matRowDef="let produto; columns: displayedColumns;"
    class="produto-row"
    [class.expanded-row]="expandedElement === produto"
    (click)="expandedElement = expandedElement === produto ? null : produto"></tr>
  <tr mat-row *matRowDef="let produto; columns: ['expandedDetail']" [class.produto-expandido]="expandedElement === produto"
    class="detail-row"></tr>
</table>

<div *ngIf="produtos.length === 0" class="mensagem-nenhum-item-tabela">
  <span>Não há nenhum produto cadastrado</span>
</div>

<mat-paginator [length]="tamanhoPaginacao" [pageSize]="tamanhoPagina" [pageSizeOptions]="opcoesPaginacao"
  [pageIndex]="indicePagina" (page)="mudouPagina($event)">
</mat-paginator>
